{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a7952710",
   "metadata": {},
   "source": [
    "### 01"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b3a4d25c",
   "metadata": {},
   "outputs": [],
   "source": [
    "import os\n",
    "import pandas as pd\n",
    "ldir=os.chdir(r'C:\\Users\\Narshan\\Python')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "b4a39051",
   "metadata": {},
   "outputs": [],
   "source": [
    "df=pd.read_csv('Ertekesites(ETL).csv',delimiter=';',encoding=\"ISO-8859-2\",parse_dates=['Dátum'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a96b17f1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dátum</th>\n",
       "      <th>Kategórianév</th>\n",
       "      <th>Terméknév</th>\n",
       "      <th>Egységár</th>\n",
       "      <th>Mennyiség</th>\n",
       "      <th>Érték</th>\n",
       "      <th>Vevőnév</th>\n",
       "      <th>Vevő megye</th>\n",
       "      <th>Vevő város</th>\n",
       "      <th>Bolt megye</th>\n",
       "      <th>Bolt város</th>\n",
       "      <th>Boltnév</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2015-01-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Tol</td>\n",
       "      <td>400,00 Ft</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3 200 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2015-01-13</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500,00 Ft</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3 000 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2015-01-23</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500,00 Ft</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2015-01-24</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700,00 Ft</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>-2 800 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2015-02-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Toll</td>\n",
       "      <td>400,00 Ft</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3 200 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>2017-12-06</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500,00 Ft</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3 000 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>2017-12-03</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700,00 Ft</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>2017-12-07</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700,00 Ft</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>2017-12-12</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700,00 Ft</td>\n",
       "      <td>9.0</td>\n",
       "      <td>6 300 Ft</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>2017-12-14</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Kártya</td>\n",
       "      <td>500,00 Ft</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>232 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Dátum Kategórianév Terméknév   Egységár  Mennyiség       Érték  \\\n",
       "0   2015-01-02        Iroda       Tol  400,00 Ft        8.0   3 200 Ft    \n",
       "1   2015-01-13        Játék     Labda  500,00 Ft        6.0   3 000 Ft    \n",
       "2   2015-01-23        Játék     Labda  500,00 Ft        3.0   1 500 Ft    \n",
       "3   2015-01-24         Kert  Gereblye  700,00 Ft       -4.0  -2 800 Ft    \n",
       "4   2015-02-02        Iroda      Toll  400,00 Ft        8.0   3 200 Ft    \n",
       "..         ...          ...       ...        ...        ...         ...   \n",
       "227 2017-12-06        Játék     Labda  500,00 Ft        6.0   3 000 Ft    \n",
       "228 2017-12-03         Kert       Ásó  700,00 Ft        5.0   3 500 Ft    \n",
       "229 2017-12-07         Kert       Ásó  700,00 Ft        5.0   3 500 Ft    \n",
       "230 2017-12-12         Kert  Gereblye  700,00 Ft        9.0   6 300 Ft    \n",
       "231 2017-12-14        Játék    Kártya  500,00 Ft        7.0   3 500 Ft    \n",
       "\n",
       "       Vevőnév Vevő megye Vevő város Bolt megye Bolt város Boltnév  \n",
       "0    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "1    Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "2     Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "3     Nagy Kft      Heves   Gyöngyös       Pest    Gödöllő  2. ABC  \n",
       "4    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "..         ...        ...        ...        ...        ...     ...  \n",
       "227  Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "228   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  2. ABC  \n",
       "229   Tóth Kft      Heves       Eger      Heves       Eger  1. ABC  \n",
       "230   Tóth Kft      Heves       Eger      Heves   Gyöngyös  1. ABC  \n",
       "231   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "\n",
       "[232 rows x 12 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c9cfbc37",
   "metadata": {},
   "source": [
    "### 02"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "9acfb558",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dátum</th>\n",
       "      <th>Kategórianév</th>\n",
       "      <th>Terméknév</th>\n",
       "      <th>Egységár</th>\n",
       "      <th>Mennyiség</th>\n",
       "      <th>Érték</th>\n",
       "      <th>Vevőnév</th>\n",
       "      <th>Vevő megye</th>\n",
       "      <th>Vevő város</th>\n",
       "      <th>Bolt megye</th>\n",
       "      <th>Bolt város</th>\n",
       "      <th>Boltnév</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2015-01-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Tol</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3 200 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2015-01-13</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3 000 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2015-01-23</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2015-01-24</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>-2 800 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2015-02-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Toll</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3 200 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>2017-12-06</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3 000 Ft</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>2017-12-03</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>2017-12-07</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>2017-12-12</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>6 300 Ft</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>2017-12-14</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Kártya</td>\n",
       "      <td>500</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3 500 Ft</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>232 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Dátum Kategórianév Terméknév  Egységár  Mennyiség       Érték  \\\n",
       "0   2015-01-02        Iroda       Tol       400        8.0   3 200 Ft    \n",
       "1   2015-01-13        Játék     Labda       500        6.0   3 000 Ft    \n",
       "2   2015-01-23        Játék     Labda       500        3.0   1 500 Ft    \n",
       "3   2015-01-24         Kert  Gereblye       700       -4.0  -2 800 Ft    \n",
       "4   2015-02-02        Iroda      Toll       400        8.0   3 200 Ft    \n",
       "..         ...          ...       ...       ...        ...         ...   \n",
       "227 2017-12-06        Játék     Labda       500        6.0   3 000 Ft    \n",
       "228 2017-12-03         Kert       Ásó       700        5.0   3 500 Ft    \n",
       "229 2017-12-07         Kert       Ásó       700        5.0   3 500 Ft    \n",
       "230 2017-12-12         Kert  Gereblye       700        9.0   6 300 Ft    \n",
       "231 2017-12-14        Játék    Kártya       500        7.0   3 500 Ft    \n",
       "\n",
       "       Vevőnév Vevő megye Vevő város Bolt megye Bolt város Boltnév  \n",
       "0    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "1    Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "2     Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "3     Nagy Kft      Heves   Gyöngyös       Pest    Gödöllő  2. ABC  \n",
       "4    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "..         ...        ...        ...        ...        ...     ...  \n",
       "227  Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "228   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  2. ABC  \n",
       "229   Tóth Kft      Heves       Eger      Heves       Eger  1. ABC  \n",
       "230   Tóth Kft      Heves       Eger      Heves   Gyöngyös  1. ABC  \n",
       "231   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "\n",
       "[232 rows x 12 columns]"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "df['Egységár'] = df['Egységár'].str.replace('Ft', '').str.replace(',','.')\n",
    "df['Egységár'] = pd.to_numeric(df['Egységár']).astype('Int32')\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "f957ae27",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dátum</th>\n",
       "      <th>Kategórianév</th>\n",
       "      <th>Terméknév</th>\n",
       "      <th>Egységár</th>\n",
       "      <th>Mennyiség</th>\n",
       "      <th>Érték</th>\n",
       "      <th>Vevőnév</th>\n",
       "      <th>Vevő megye</th>\n",
       "      <th>Vevő város</th>\n",
       "      <th>Bolt megye</th>\n",
       "      <th>Bolt város</th>\n",
       "      <th>Boltnév</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2015-01-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Tol</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3200</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2015-01-13</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3000</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2015-01-23</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1500</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2015-01-24</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>-2800</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2015-02-02</td>\n",
       "      <td>Iroda</td>\n",
       "      <td>Toll</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3200</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>2017-12-06</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3000</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>2017-12-03</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3500</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>2017-12-07</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3500</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>2017-12-12</td>\n",
       "      <td>Kert</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>6300</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>2017-12-14</td>\n",
       "      <td>Játék</td>\n",
       "      <td>Kártya</td>\n",
       "      <td>500</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3500</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>232 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Dátum Kategórianév Terméknév  Egységár  Mennyiség  Érték    Vevőnév  \\\n",
       "0   2015-01-02        Iroda       Tol       400        8.0   3200  Kovács Bt   \n",
       "1   2015-01-13        Játék     Labda       500        6.0   3000  Kovács Bt   \n",
       "2   2015-01-23        Játék     Labda       500        3.0   1500   Nagy Kft   \n",
       "3   2015-01-24         Kert  Gereblye       700       -4.0  -2800   Nagy Kft   \n",
       "4   2015-02-02        Iroda      Toll       400        8.0   3200  Kovács Bt   \n",
       "..         ...          ...       ...       ...        ...    ...        ...   \n",
       "227 2017-12-06        Játék     Labda       500        6.0   3000  Kovács Bt   \n",
       "228 2017-12-03         Kert       Ásó       700        5.0   3500   Nagy Kft   \n",
       "229 2017-12-07         Kert       Ásó       700        5.0   3500   Tóth Kft   \n",
       "230 2017-12-12         Kert  Gereblye       700        9.0   6300   Tóth Kft   \n",
       "231 2017-12-14        Játék    Kártya       500        7.0   3500   Nagy Kft   \n",
       "\n",
       "    Vevő megye Vevő város Bolt megye Bolt város Boltnév  \n",
       "0         Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "1         Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "2        Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "3        Heves   Gyöngyös       Pest    Gödöllő  2. ABC  \n",
       "4         Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "..         ...        ...        ...        ...     ...  \n",
       "227       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "228      Heves   Gyöngyös      Heves   Gyöngyös  2. ABC  \n",
       "229      Heves       Eger      Heves       Eger  1. ABC  \n",
       "230      Heves       Eger      Heves   Gyöngyös  1. ABC  \n",
       "231      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "\n",
       "[232 rows x 12 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Érték'] = df['Érték'].str.replace('Ft', '').str.replace(' ','')\n",
    "df['Érték'] = pd.to_numeric(df['Érték']).astype('Int32')\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bbd3f1d8",
   "metadata": {},
   "source": [
    "### 03"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "a1369277",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df.dropna(subset=[\"Mennyiség\"])\n",
    "df['Kategórianév']=df.loc[:,('Kategórianév')]=\"ismeretlen\"\n",
    "#df['Egységár'] = df['Egységár'].str.replace('Ft', '').str.replace(',','.')\n",
    "#df['Egységár'] = pd.to_numeric(df['Egységár']).astype('Int32')\n",
    "df[\"Érték\"] = df[\"Egységár\"]*df['Mennyiség']\n",
    "df.rename(columns = {'Érték':'Bevétel'}, inplace = True)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52b3685b",
   "metadata": {},
   "source": [
    "### 04"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "ec9b41d0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Dátum</th>\n",
       "      <th>Kategórianév</th>\n",
       "      <th>Terméknév</th>\n",
       "      <th>Egységár</th>\n",
       "      <th>Mennyiség</th>\n",
       "      <th>Bevétel</th>\n",
       "      <th>Vevőnév</th>\n",
       "      <th>Vevő megye</th>\n",
       "      <th>Vevő város</th>\n",
       "      <th>Bolt megye</th>\n",
       "      <th>Bolt város</th>\n",
       "      <th>Boltnév</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2015-01-02</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Tol</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3200.0</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2015-01-13</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2015-01-23</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1500.0</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2015-01-24</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>-4.0</td>\n",
       "      <td>-2800.0</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2015-02-02</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Toll</td>\n",
       "      <td>400</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3200.0</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>227</th>\n",
       "      <td>2017-12-06</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Labda</td>\n",
       "      <td>500</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3000.0</td>\n",
       "      <td>Kovács Bt</td>\n",
       "      <td>Pest</td>\n",
       "      <td>Gödöllő</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>228</th>\n",
       "      <td>2017-12-03</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>2. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229</th>\n",
       "      <td>2017-12-07</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Ásó</td>\n",
       "      <td>700</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>230</th>\n",
       "      <td>2017-12-12</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Gereblye</td>\n",
       "      <td>700</td>\n",
       "      <td>9.0</td>\n",
       "      <td>6300.0</td>\n",
       "      <td>Tóth Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Eger</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>231</th>\n",
       "      <td>2017-12-14</td>\n",
       "      <td>ismeretlen</td>\n",
       "      <td>Kártya</td>\n",
       "      <td>500</td>\n",
       "      <td>7.0</td>\n",
       "      <td>3500.0</td>\n",
       "      <td>Nagy Kft</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>Heves</td>\n",
       "      <td>Gyöngyös</td>\n",
       "      <td>1. ABC</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>232 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         Dátum Kategórianév Terméknév  Egységár  Mennyiség  Bevétel  \\\n",
       "0   2015-01-02   ismeretlen       Tol       400        8.0   3200.0   \n",
       "1   2015-01-13   ismeretlen     Labda       500        6.0   3000.0   \n",
       "2   2015-01-23   ismeretlen     Labda       500        3.0   1500.0   \n",
       "3   2015-01-24   ismeretlen  Gereblye       700       -4.0  -2800.0   \n",
       "4   2015-02-02   ismeretlen      Toll       400        8.0   3200.0   \n",
       "..         ...          ...       ...       ...        ...      ...   \n",
       "227 2017-12-06   ismeretlen     Labda       500        6.0   3000.0   \n",
       "228 2017-12-03   ismeretlen       Ásó       700        5.0   3500.0   \n",
       "229 2017-12-07   ismeretlen       Ásó       700        5.0   3500.0   \n",
       "230 2017-12-12   ismeretlen  Gereblye       700        9.0   6300.0   \n",
       "231 2017-12-14   ismeretlen    Kártya       500        7.0   3500.0   \n",
       "\n",
       "       Vevőnév Vevő megye Vevő város Bolt megye Bolt város Boltnév  \n",
       "0    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "1    Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "2     Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "3     Nagy Kft      Heves   Gyöngyös       Pest    Gödöllő  2. ABC  \n",
       "4    Kovács Bt       Pest    Gödöllő      Heves       Eger  2. ABC  \n",
       "..         ...        ...        ...        ...        ...     ...  \n",
       "227  Kovács Bt       Pest    Gödöllő      Heves   Gyöngyös  1. ABC  \n",
       "228   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  2. ABC  \n",
       "229   Tóth Kft      Heves       Eger      Heves       Eger  1. ABC  \n",
       "230   Tóth Kft      Heves       Eger      Heves   Gyöngyös  1. ABC  \n",
       "231   Nagy Kft      Heves   Gyöngyös      Heves   Gyöngyös  1. ABC  \n",
       "\n",
       "[232 rows x 12 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df\n",
    "df.Terméknév=df.Terméknév.replace(['creuza','cerza'],'Ceruza')\n",
    "df.Terméknév=df.Terméknév.replace(['tol'],'Tol')\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b092d7e0",
   "metadata": {},
   "source": [
    "### 05"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "86fd61eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0      8.0\n",
       "1      6.0\n",
       "2      3.0\n",
       "3      4.0\n",
       "4      8.0\n",
       "      ... \n",
       "227    6.0\n",
       "228    5.0\n",
       "229    5.0\n",
       "230    9.0\n",
       "231    7.0\n",
       "Name: Mennyiség, Length: 232, dtype: float64"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\n",
    "df['Mennyiség']=abs(df['Mennyiség'])\n",
    "import numpy as np\n",
    "df.loc[(df.Mennyiség>200)]=np.NaN\n",
    "df['Mennyiség'].interpolate(method='linear') \n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f1e64028",
   "metadata": {},
   "source": [
    "### 06"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "446c4ce8",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df=df[df.duplicated()]\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "b6c53e11",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "df=df.drop_duplicates(subset='Dátum',keep='last')\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d770478c",
   "metadata": {},
   "source": [
    "### 07"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "ac21259f",
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('Javított', sep=',')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "fe52ef5f",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
